{%extends 'base.html'%} {% block content%} {%load static%}

<div class="mt-2">
  <h1>
    Pedido {{pedido.id}}
  </h1>

  <form action="{%url 'pedido_detalle' pedido.id %}" method="POST" class="formDetalle">
    {% csrf_token%}
    <div class="form-group row mt-4">
      <!-- Revisar formato BOOL -->
      <label for="pedidoPlanificado" class="col-sm-2 col-form-label">Planificado: </label>
      <div class="col-sm-10">
        <input type="checkbox" name="pedidoPlanificado" id="" {% if pedido.planificado %} checked{% endif %} />
      </div>

      <label for="pedidoProducido" class="col-sm-2 col-form-label">Producido: </label>
      <div class="col-sm-10">
        <input type="checkbox" name="pedidoProducido" id="" {% if pedido.producido %} checked{% endif %} />
      </div>

      <label for="pedidoCantidad" class="col-sm-2 col-form-label">Cantidad: </label>
      <div class="col-sm-10">
        <input type="text" class="form-control" id="pedidoCantidad" name="pedidoCantidad" value="{{pedido.cantidad}}" />
      </div>

      <label for="pedidoReferencia" class="col-sm-2 col-form-label">Referencia: </label>
      <div class="col-sm-10">
        <select name="pedidoReferencia" id="" class="form-control">
          {%for prod in productos%}
          <option value="{{prod.id}}" {% if pedido.catalogo.id == prod.id %} selected {%endif%}> {{prod.nombre}}
          </option>
          {%endfor%}
        </select>

      </div>

      <label for="pedidoCliente" class="col-sm-2 col-form-label">Cliente: </label>
      <div class="col-sm-10">
        <select name="pedidoCliente" id="" class="form-control">
          {%for cl in clientes%}
          <option value="{{cl.id}}" {% if pedido.cliente.id == cl.id %} selected {%endif%}>{{cl.nombre}} </option>
          {%endfor%}
        </select>

        <!-- <input type="text" class="form-control" id="pedidoCliente" name="pedidoCliente" value="{{pedido.cliente}}" /> -->
      </div>
    </div>
    <input type="hidden" name="id" value={{pedido.id}}>
    <input type="submit" class="btn btn-secondary" value="Guardar" />
  </form>

  <form action="{%url 'pedido_delete' %}" method="POST" class="formDetalle">
    {% csrf_token%}
    <input type="hidden" name="idPedido" value="{{pedido.id}}">
    <input type="submit" class="btn btn-danger" value="Eliminar">
  </form>
</div>



<div>
  <hr>
  <h2>
    Tareas de este pedido:
  </h2>

  {% if tareas %}
  {%for tarea in tareas %}
  <p>
    {{tarea}}
  </p>
  {%endfor%}
  {% else %}
  No hay tareas.
  {% endif %}



  <hr>
  <h2>
    Añadir tarea a este pedido:
  </h2>
  <form action="" id="formNuevaTarea">
    {% csrf_token%}
    <label for="">Finalizada: {{form.finalizada}}</label> <br>
    <label for="">Hora inicio: {{form.hora_inicio}}</label> <br>
    <label for="">Hora fin: {{form.hora_fin}}</label> <br>
    <label for="">Equipo: {{form.equipo}}</label> <br>
    <label for="">Proceso: {{form.proceso}}</label> <br>
    <label for="">Empleados asignados: {{form.empleados_asignados}}</label> <br>
    <input type="hidden" name="idPedido" value="{{pedido.id}}">
    <button class="btn btn-secondary" name="btnAñadir" id="elBoton">Añadir tarea a este pedido</button>
  </form>
</div>
{%endblock%}

{%block scripts%}
<script src="{% static 'js/pedido_detalle.js'%}"></script>
{%endblock%}